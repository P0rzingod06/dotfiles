<?xml version="1.0"?>
<ProcessingGroup 
	name="QSYS-Default" 
	priority="60"
  ordersPerBatch="10"   
	parent="StandardOrder"
	errorAlertThreshold = "120"
	ruleApplicationSource = "OTOS">
	
<!-- CVS Header: $Source: /CVS/oracle11i/applint/rules_config/om/ProcessingGroup-QSYS-Default.xml,v $, $Revision: 1.138 $, $Author: gasparob $, $Date: 2015/09/24 15:12:52 $ -->	

<!-- Processing Group Criteria -->
<CriteriaSet>
	<Criteria>
		<tableName>APPS.WWT_ORIG_ORDER_HEADERS</tableName>
		<columnName>SOURCE</columnName>
		<value>QSYS</value>
	</Criteria>
</CriteriaSet>

<CriteriaSet>
	<Criteria>
		<tableName>APPS.WWT_ORIG_ORDER_HEADERS</tableName>
		<columnName>SOURCE</columnName>
		<value>QSYS_3</value>
	</Criteria>
</CriteriaSet>

<!-- ******************************** -->
<!-- ****** BEGIN PRE-PROCESS ******* -->
<!-- ******************************** -->

<!-- Project Names are controlled with WWT_OTOS_PREVIEW_LINE_VALUES lookup PG ID 34 -->
<!-- Add additional Project Names to this lookup -->
<Rule name="Check to see if this order contains project name values located in the preview value lookup for task creation and set flag" class="PRE-PROCESS"  executeOnReprocess="N">
	<ConditionSet name="Check to see if this order contains certain project names for creation of task name" exitOnSuccess="Y">
		<Action name="Set flag for later Processing" class="previewLineValue">
			 <Parameter name="useLookup" valueType="STATIC">Y</Parameter>
			 <Parameter name="elementToCheck" valueType="STATIC">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			 <Parameter name="checkValue" valueType="STATIC"></Parameter>
			 <Parameter name="targetElement" valueType="STATIC">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar4</Parameter>
			 <Parameter name="targetValue" valueType="STATIC">Y</Parameter>
			 <ExceptionHandler type="ERROR">Could not set Project/Task Indicator Flag</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- ******************************** -->
<!-- ****** BEGIN HEADER ************ -->
<!-- ******************************** -->

<Rule name="Lookup DFF Context" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Lookup DFF Context" exitOnSuccess="Y">
		<Action name="Lookup DFF Context" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">qsysLookupDFFContextOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">REPOS</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/CONTEXT</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LOGIC TO CALCULATE AND APPLY THE SEWP CONTRACT FEE FOR TONER IF IT WAS NOT CALCULATED IN QSYS -->
<Rule name="Calculate and apply DOJ Toner contract fee if NULL" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Calculate DOJ Toner contract fee if NULL" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DOJ Toner</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE6</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Calculate DOJ Toner contract fee" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">qsysCalcContractFeeOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">REPOS</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE6</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Add fee line to the order" class="qsysFees">
			<Parameter name="salesCreditType" valueType="STATIC">Quota Sales Credit</Parameter>
			<ExceptionHandler type="WARN">Could not add fee line to order</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Map contract fee to wdff.attribute24 for some quote contracts" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Subset of quote contracts" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
			<Operator>IN</Operator> 
			<RHSValue valueType="LOOKUP">CONTRACT_FEE_QUOTE_CONTRACTS</RHSValue>
		</Condition>
		<Action name="Map contract fee" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE6</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE24</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Map contract fee to wdff.attribute24 for more quote contracts" class="HEADER" executeOnReprocess="N"> <!--duplicate rule from above, lookup ran out of space. Needed more quote contracts -->
	<ConditionSet name="Subset of quote contracts" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
			<Operator>IN</Operator> 
			<RHSValue valueType="LOOKUP">MORE_CONTRACT_FEE_QUOTE_CONTRACTS</RHSValue>
		</Condition>
		<Action name="Map contract fee" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE6</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE24</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- LOGIC TO SEE IF AN INVALID SALESREP HAS BEEN USED -->
<Rule name="Check for valid salesrep when ORG_ID is NULL" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Check ORG_ID" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<!-- THE MULTI ITEM BELOW WILL POPULATE ORG_ID-->
		<Action name="Check Salesrep" class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">QSYSCheckSalesrepOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="actionOnMultiple" valueType="STATIC">ERROR</Parameter>
			<ExceptionHandler type="ERROR"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Custom field mappings for State of Alaska" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="State of Alaska" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Comm - Alaska Kemp</RHSValue>
		</Condition>
		<Action name="Map two custom eStore fields to the Mark For field " class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="field2" valueType="STATIC">/</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE22</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/ATTRIBUTE9</Parameter>
			<ExceptionHandler type="WARN">Could not build Mark For with custom fields</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Custom field mappings for MTS Systems Corporation" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="MTS Systems Corporation eStore Orders" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">MTS Systems Corporation</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Map custom eStore field to the Mark For field " class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/ATTRIBUTE9</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Custom field mappings for MTS Systems Corporation eStore Orders" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="MTS Systems Corporation eStore Orders" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Spherion</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Map custom eStore field to the Mark For field " class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/ATTRIBUTE9</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Custom field mappings for VHA" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="VHA" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">VHA Inc.</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Map three custom eStore fields to the Mark For field " class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="field2" valueType="STATIC">/</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/ATTRIBUTE9</Parameter>
			<ExceptionHandler type="WARN">Could not build Mark For with custom fields</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>


<!-- TRANSACTION TYPE LOGIC AND SHIPPING INSTRUCTION CONCATENATE -->
<Rule name="Transaction_Type and VAT_Info mappings" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Transaction Type Check" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">%Export%</RHSValue>
		</Condition>
		<Action name="Parse Transaction Type" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">-</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Attribute49" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">EXPORT</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Concatenate Additional Shipping Instructions" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="field2" valueType="STATIC">-</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="field4" valueType="STATIC">, VAT Country - </Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE50</Parameter>
			<Parameter name="field6" valueType="STATIC">, VAT # </Parameter>
			<Parameter name="field7" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE51</Parameter>
			<Parameter name="field8" valueType="STATIC">, </Parameter>
			<Parameter name="field9" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="maxLength" valueType="STATIC">2000</Parameter>
			<ExceptionHandler type="WARN">Shipping Instruction build failed.</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>
<!-- Intra-Community TRANSACTION TYPE LOGIC AND SHIPPING INSTRUCTION CONCATENATE -->
<Rule name="Intra-Community Transaction_Type and VAT_Info mappings" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Transaction Type Check" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">%Intra%</RHSValue>
		</Condition>
		<Action name="Parse Transaction Type" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">(</Parameter>
			<Parameter name="endMarker" valueType="STATIC">)</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Attribute49" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">INTRACOMMUNITY</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Shipping Instructions" class="simpleLookup">
			<Parameter name="lookupType" valueType="STATIC">EXPORT_SHIP_TYPE</Parameter>
			<Parameter name="attribute1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="returnColumn1" valueType="STATIC">ATTRIBUTE3</Parameter>
			<Parameter name="targetElement1" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Concatenate Additional Shipping Instructions" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="field2" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="field4" valueType="STATIC"> VAT # </Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE51</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="maxLength" valueType="STATIC">2000</Parameter>
			<ExceptionHandler type="WARN">Shipping Instruction build failed.</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- Domestic TRANSACTION TYPE LOGIC AND SHIPPING INSTRUCTION CONCATENATE -->
<Rule name="Domestic Transaction_Type and VAT_Info mappings" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Transaction Type Check" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">%Domestic%</RHSValue>
		</Condition>
		<Action name="Parse Transaction Type" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">(</Parameter>
			<Parameter name="endMarker" valueType="STATIC">)</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Attribute49" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">DOMESTIC</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Shipping Instructions" class="simpleLookup">
			<Parameter name="lookupType" valueType="STATIC">EXPORT_SHIP_TYPE</Parameter>
			<Parameter name="attribute1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="returnColumn1" valueType="STATIC">ATTRIBUTE3</Parameter>
			<Parameter name="targetElement1" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Concatenate Additional Shipping Instructions" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="field2" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE49</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE52</Parameter>
			<Parameter name="field4" valueType="STATIC"> VAT # </Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE51</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="maxLength" valueType="STATIC">2000</Parameter>
			<ExceptionHandler type="WARN">Shipping Instruction build failed.</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- THIS IS USED IN THE UNIQUE ITEM # CREATION.-->
<Rule name="Header level rules for Maintenance Orders that need Unique Parts created" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Seed the line number" exitOnSuccess="Y">		
		<Action name="Seed the line number" class="assignment">
			 <Parameter name="sourceElement" valueType="STATIC">0</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>		
	</ConditionSet>
</Rule>  

<!-- CUSTOMER FIELD MAPPING FOR STATE OF MISSOURI-->
<Rule name="Set SOM Flag, Auto Create Contacts, and Auto Create Addresses" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Create All Contacts for SOM" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">State of MO-PVC-EDK,State of MO-PVC-EDH,State of MO-PVC-ST,State of MO-Cisco,State of Kansas,State of Kansas - Sun</RHSValue>
		</Condition>
		<Action name="Set SOM FLAG" class="assignment">
			 <Parameter name="sourceElement" valueType="STATIC">Y</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar2</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Create Ordered By Contact" class="createOrderedByContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">Y</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">Y</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Ordered By Contact</ExceptionHandler>
		</Action>
		<Action name="Create Ship To Contact" class="createShipToContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">Y</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">Y</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Ship To Contact</ExceptionHandler>
		</Action>
		<Action name="Create Invoice To Contact" class="createInvoiceToContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">Y</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">Y</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Invoice To Contact</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Create All Addresses for SOM" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Create Ship To Address" class="createShipToAddress">
			<ExceptionHandler type="ERROR">Could not autocreate Ship To Address</ExceptionHandler>
		</Action>
		<Action name="Create Invoice To Address" class="createInvoiceToAddress">
			<ExceptionHandler type="ERROR">Could not autocreate Invoice To Address</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- CUSTOM HEADER MAPPING FOR EXELON -->
<Rule name="Custom field mappings for Exelon" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Exelon" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Exelon Corporation</RHSValue>
		</Condition>
		<Action name="Map 5 custom eStore fields to the Mark For field " class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="field2" valueType="STATIC">;</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE22</Parameter>
			<Parameter name="field4" valueType="STATIC">;</Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE23</Parameter>
			<Parameter name="field6" valueType="STATIC">;</Parameter>
			<Parameter name="field7" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE24</Parameter>
			<Parameter name="field8" valueType="STATIC">;</Parameter>
			<Parameter name="field9" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE25</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/ATTRIBUTE9</Parameter>
			<ExceptionHandler type="WARN">Could not build Exelon Mark For with custom fields</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- United Airline set up for Fedex number -->
<Rule name="Set Fedex for United Airline" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Set Fedex for United Airline" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">UNITED_AIRLINE_SALESREP</RHSValue>
		</Condition>
		<Action name="Map Fedex number" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<Parameter name="field2" valueType="STATIC">|</Parameter>
			<Parameter name="field3" valueType="LOOKUP">UNITED_AIRLINE_MESSAGE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/SHIPPING_INSTRUCTIONS</Parameter>
			<ExceptionHandler type="ERROR">Could not build shipping instructions for United Airline</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LOGIC TO STOP THE ORDER IN OCU FOR PGE ORDERS -->
<Rule name="If the Sales Channel is Comm - PGE stop the order in OCU" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="If the Sales Channel is Comm - PGE stop the order in OCU" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Comm - PGE</RHSValue>
		</Condition>	
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/AGREEMENT</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">ABC123</RHSValue>
		</Condition>	
		<Action name="Write an error to OCU" class="recordException">			
			<Parameter name="exceptionType" valueType="STATIC">ERROR</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">At business request, order was stopped in OCU. Please make any updates and reprocess.</Parameter>			
		</Action>			
	</ConditionSet>
</Rule>	

<!-- AUTOCREATE ADDRESSES -->  
<Rule name="Autocreate Addresses for Sales Channel 'Sprint - Cisco'" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Autocreate Addresses" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Sprint - Cisco</RHSValue>
		</Condition>	
		<Action name="Autocreate Ship To Address" class="createShipToAddress">
			<ExceptionHandler type="ERROR">Could not create Ship To Address</ExceptionHandler>
		</Action>
		<Action name="Autocreate Deliver To Address" class="createDeliverToAddress">
			<ExceptionHandler type="ERROR">Could not create Deliver To Address</ExceptionHandler>
		</Action>
		<Action name="Autocreate Invoice To Address" class="createInvoiceToAddress">
			<ExceptionHandler type="ERROR">Could not create Invoice To Address</ExceptionHandler>
		</Action>
		<Action name="Autocreate End Customer Address" class="createEndCustomerAddress">
			<ExceptionHandler type="ERROR">Could not create End Customer Address</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule> 
 
<!--AUTOCREATE BY CONTACT -->
<Rule name="Autocreate Contacts for Sales Channel 'Sprint - Cisco'" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Autocreate Contacts" exitOnSuccess="Y">
	<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Sprint - Cisco</RHSValue>
		</Condition>
		<Action name="Autocreate Ordered By Contact" class="createOrderedByContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">N</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">N</Parameter>			
			<ExceptionHandler type="ERROR">Could not autocreate Ordered By Contact</ExceptionHandler>	
		</Action>
		<Action name="Autocreate Ship To Contact" class="createShipToContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">N</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Ship To Contact</ExceptionHandler>
		</Action>
		<Action name="Autocreate Invoice To Contact" class="createInvoiceToContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">N</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Invoice To Contact</ExceptionHandler>
		</Action>
		<Action name="Autocreate Deliver To Contact" class="createDeliverToContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">N</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate Deliver To Contact</ExceptionHandler>
		</Action>
	  <Action name="Autocreate End Customer Contact" class="createEndCustomerContact">
			<Parameter name="receiveASNAlert" valueType="STATIC">N</Parameter>
			<Parameter name="receiveBookedOrderAlert" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="ERROR">Could not autocreate End Customer Contact</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--Netcents-2P Major Command Mapping-->
<Rule name="Netcents-2P Set Attribute34 to Major Command" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Set Attribute 34 to Major Command" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Netcents-2P</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE16</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">ACC,AETC,AF,AF ISR AGENCY,AFCESA,AFDW,AFGSC,AFLMC,AFMC,AFOTEC,AFPC,AFRC,AFSEC,AFSOC,AFSPC,AFSPC,AMC,ANG,PACAF,USAF,USAF-AFAFRIC,USAFA,USCENTCOM</RHSValue>
		</Condition>	
		<Action name="Set Attribute34" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE16</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE34</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		</ConditionSet>
</Rule>

<Rule name="Netcents-2P Set Attribute16" class="HEADER" executeOnReprocess="Y">
	<ConditionSet name="Set Attribute16 to Bid Number" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Netcents-2P</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE34</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>	
		<Action name="Set Attribute16" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/ATTRIBUTE3</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE16</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action> 
		</ConditionSet>
</Rule>

<!-- 	when the same Quote hits ORIG twice (due to network issues, DR site and the site here have the same 
      request but are not talking with one another), it will create 2 SO's from the same quote. So we need
      to fail them to ORIG so the business can process 1 and cancel the other one.  -->
<Rule  name="For Quote System 3 order only, check for Dup Orders" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="check for Dup Orders" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
		<Action name="check for Dup Orders" class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">dupQsys3OrderCheckOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE4</Parameter>
			<Parameter name="sourceElement2" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CUSTOMER_PO_NUMBER</Parameter>
			<Parameter name="sourceElement3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Dup Order found fail to ORIG" exitOnSuccess="N"> 
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/foundDupQsysOrder</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
		<Action name="Send email when an order was updated" class="sendInternalEmail">
			<Parameter name="subject" valueType="STATIC">Duplicate Orders were found</Parameter>
			<Parameter name="toList" valueType="LOOKUP">QSYS3_DUP_PO_EMAIL_DIST_LIST</Parameter>
			<Parameter name="body" valueType="STATIC">
       Orig Header ID: %WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID%
       Customer PO Number: %WWT_STG_ORDER_HEADERS/CUSTOMER_PO_NUMBER%
       Quote ID:  %WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE4%
       
       For above record, we found during processing the same batch to STG that 2 orders came in with the same PO, Quote  ID.
       This could of been due to the network having the same request and processing both by accident.
      </Parameter>
			<ExceptionHandler type="WARN">Could not send email</ExceptionHandler>
		</Action>
		<Action name="Fail the order" class="recordException">
			<Parameter name="exceptionType" valueType="STATIC">FAIL</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">We found during processing this record it had a duplicate in the same batch with the same PO, Quote  ID. This could of been due to the network having the same request and processing both by accident. Please go to COP Cleanup form and process one of the duplicate orders through and cancel the other.</Parameter>
		</Action>
	</ConditionSet>	
</Rule>

<!--CREATE CONVERSION TYPE -->
<Rule name="International - New Quote System - Create Conversion Type" class="HEADER" executeOnReprocess="Y">
	<ConditionSet name="IF TRANSACTIONAL_CURR_CODE != USD set Conversion Type to Spot" exitOnSuccess="Y">
	  <Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/TRANSACTIONAL_CURR_CODE</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">USD</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
			<Action name="Set Type" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CONVERSION_TYPE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/CONVERSION_TYPE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
			</Action>
	</ConditionSet>
	<ConditionSet name="ELSE TRANSACTIONAL_CURR_CODE = USD set Conversion Type to NULL" exitOnSuccess="Y">
	  <Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/TRANSACTIONAL_CURR_CODE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">USD</RHSValue>
		</Condition>
			<Action name="Set Type" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/CONVERSION_TYPE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
			</Action>
	</ConditionSet>
</Rule>

<!--GET PRICE LIST  -->
<Rule name="International - New Quote System - Get Price List" class="HEADER" executeOnReprocess="Y">
	<ConditionSet name="Get Price List" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Lookup Price List" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getInternationalVARPriceListOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/PRICE_LIST</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- Set Header DFF Context for WIDEOPENWEST orders-->
<Rule name="Set Header DFF Context for WIDEOPENWEST orders" class="HEADER" executeOnReprocess="N">
	<ConditionSet name="Set DFF Context" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">WideOpenWest Finance, LLC</RHSValue>
		</Condition>
			<Action name="Set DFF Context" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">WideOpenWest Finance</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/CONTEXT</Parameter>
			<ExceptionHandler type="WARN">Could not set Header DFF value</ExceptionHandler>
		    </Action>
	</ConditionSet>
</Rule>

<!--db Constant that will compare inbound ship address to customer standards - then will bring back Cisco Site ID/WOW Site ID/DNCS Site ID 1-->
<Rule name="Query to locate Cisco Site ID/WOW Site ID/DNCS Site ID information in customer standards" class="HEADER" executeOnReprocess="Y">	
	<ConditionSet name="Query to pull site id from customer standards" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">WideOpenWest Finance, LLC</RHSValue>
		</Condition>
		<Action name="Concatenate ship to address 1 and ship to address 2 fields to the Mark For field" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIP_TO_ADDRESS1</Parameter>
			<Parameter name="field2" valueType="STATIC">, </Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/SHIP_TO_ADDRESS2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/OTOSTempVariables/tempVar5</Parameter>
			<ExceptionHandler type="WARN">Could not concatenate ship to fields</ExceptionHandler>
		</Action>
		<Action name="Check for site ids" class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getsiteidOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/OTOSTempVariables/tempVar5</Parameter>
			<ExceptionHandler type="WARN">Could not obtain Cisco Site ID WOW Site ID DNCS Site ID</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- ******************************** -->
<!-- ****** BEGIN LINES  ************ -->
<!-- ******************************** -->

 <Rule name="Set Line Type based on Quote Contract" class="LINE" executeOnReprocess="N">
 <ConditionSet name="Check Quote Contract for WH 09" exitOnSuccess="Y">
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">WWT Mixed</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
  <RHSValue valueType="LOOKUP">QSYS_DEFAULT_QUOTE_CONTRACT_09</RHSValue>
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">582</RHSValue> 
  </Condition>
 <Action name="Set WWT OEtoPO-Pick-Ship-Invoice Line Type" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">WWT OEtoPO-Pick-Ship-Invoice</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <Parameter name="overWrite" valueType="STATIC">N</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
 <ConditionSet name="Check Quote Contract for WH 04" exitOnSuccess="Y">
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">WWT Mixed</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
   <RHSValue valueType="LOOKUP">QSYS_DEFAULT_QUOTE_CONTRACT_04</RHSValue>
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">245</RHSValue> 
  </Condition>
 <Action name="Set WWT Drop Ship-Invoice Line Type" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">WWT Drop Ship-Invoice</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <Parameter name="overWrite" valueType="STATIC">N</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
 <Action name="Set Project to Null for Drop Ship Items" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC" /> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/PROJECT</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
 <ConditionSet name="Check Quote Contract for Consigned Transfer" exitOnSuccess="Y">
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
  <RHSValue valueType="STATIC">Consigned Transfer,Consigned Trigger WMS</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">101</RHSValue> 
  </Condition>
 <Action name="Set Line Type to WWT OEtoPO-AutoShip-Xfer-Inv" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">WWT OEtoPO-AutoShip-Xfer-Inv</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
 <ConditionSet name="Check Quote Contract for Telco Consigned Transfer" exitOnSuccess="Y">
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
  <RHSValue valueType="STATIC">Consigned Transfer,Consigned Trigger WMS</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">370</RHSValue> 
  </Condition>
 <Action name="Set Line Type to Telco OEtoPO-AutoShip-Xfer-Inv" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">Telco OEtoPO-AutoShip-Xfer-Inv</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
  </Rule>
  
   <Rule name="Set Line Type based on Quote Contract" class="LINE" executeOnReprocess="N">
   <ConditionSet name="Check Quote Contract for WH 09" exitOnSuccess="Y">
   <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">WWT Mixed</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
  <RHSValue valueType="LOOKUP">QSYS_DEFAULT_MORE_QUOTE_CONTRACT_09</RHSValue>
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">582</RHSValue> 
  </Condition>
 <Action name="Set WWT OEtoPO-Pick-Ship-Invoice Line Type" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">WWT OEtoPO-Pick-Ship-Invoice</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <Parameter name="overWrite" valueType="STATIC">N</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
    <ConditionSet name="Check Quote Contract for WH 04" exitOnSuccess="Y">
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">WWT Mixed</RHSValue> 
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
  <Operator>IN</Operator> 
   <RHSValue valueType="LOOKUP">QSYS_DEFAULT_MORE_QUOTE_CONTRACT_04</RHSValue>
  </Condition>
 <Condition>
  <LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue> 
  <Operator>=</Operator> 
  <RHSValue valueType="STATIC">245</RHSValue> 
  </Condition>
 <Action name="Set WWT Drop Ship-Invoice Line Type" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC">WWT Drop Ship-Invoice</Parameter> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
  <Parameter name="overWrite" valueType="STATIC">N</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
 <Action name="Set Project to Null for Drop Ship Items" class="assignment">
  <Parameter name="sourceElement" valueType="STATIC" /> 
  <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/PROJECT</Parameter> 
  <ExceptionHandler type="NONE" /> 
  </Action>
  </ConditionSet>
  </Rule>

<Rule name="Update Attribute 17 if M1/C1 field has been updated in the Quote" class="LINE" executeOnReprocess="N">
 <ConditionSet name="Check contract type" exitOnSuccess="Y">
 <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
	<Operator>IN</Operator> 
	<RHSValue valueType="LOOKUP">CMST_QUOTE_CONTRACT</RHSValue>
  </Condition>
  <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
	<Operator>NOT IN</Operator> 
	<RHSValue valueType="LOOKUP">CMST_ORDER_TYPE</RHSValue>
  </Condition>
   <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue> 
	<Operator>=</Operator> 
	<RHSValue valueType="STATIC">QSYS</RHSValue>
  </Condition>
  <Action name="Get Bundle Flag" class="multiItemQuery">
	<Parameter name="sqlConstantName" valueType="STATIC">getCmstBundleConfigOTOSSQL</Parameter>
	<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
	<Parameter name="actionOnMultiple" valueType="STATIC">ERROR</Parameter>
	<ExceptionHandler type="NONE"></ExceptionHandler>
	</Action>
 </ConditionSet>
</Rule>
  
<Rule name="Assign M/C/S to Config temp variable" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Assign M to Config temp variable for master config" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">M%</RHSValue>
		</Condition>
		   <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue> 
	<Operator>=</Operator> 
	<RHSValue valueType="STATIC">QSYS</RHSValue>
  </Condition>
		<Action name="Get Master number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/persistedOTOSTempVariables/configTempVar</Parameter>
			<Parameter name="length" valueType="STATIC">1</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Assign C to config temp variable for child config" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">C%</RHSValue>
		</Condition>
		   <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue> 
	<Operator>=</Operator> 
	<RHSValue valueType="STATIC">QSYS</RHSValue>
  </Condition>
		<Action name="Get Child number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/persistedOTOSTempVariables/configTempVar</Parameter>
			<Parameter name="length" valueType="STATIC">1</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Assign S to config temp variable for Spares" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">S%</RHSValue>
		</Condition>
		   <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue> 
	<Operator>=</Operator> 
	<RHSValue valueType="STATIC">QSYS</RHSValue>
  </Condition>
		<Action name="Get Spare number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/persistedOTOSTempVariables/configTempVar</Parameter>
			<Parameter name="length" valueType="STATIC">1</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Set Line Type based on Item Attributes" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Check Item Attributes for NonShippable, NonTransactable and NonPurchaseable for NonFee Lines" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/LINE_TYPE</LHSValue>
			<Operator>NOT IN</Operator>
			<RHSValue valueType="STATIC">WWT Non Ship-Inv At 1st Shpmnt,Telco NonShip-Inv At 1st Shpmt</RHSValue>
		</Condition>
		<Action name="Check Item Attributes" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">checkItemAttributesForNonShipLinesOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar1</Parameter>			
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Set WWT Line Type for Item Attribute Results" exitOnSuccess="Y">		
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar1</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">101</RHSValue>
		</Condition>
		<Action name="Set WWT Non Ship-Inv At 1st Shpmnt Line Type" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">WWT Non Ship-Inv At 1st Shpmnt</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
	<ConditionSet name="Set Telco Line Type for Item Attribute Results" exitOnSuccess="Y">		
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar1</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">370</RHSValue>
		</Condition>
		<Action name="Set Telco Non Ship-Inv At 1st Shpmnt Line Type" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">Telco NonShip-Inv At 1st Shpmt</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
	<ConditionSet name="If Line Type is NULL set Default Line Type" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/LINE_TYPE</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Lookup Default Line Type" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">QSYSLookupLineTypeOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<Parameter name="overWrite" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="ERROR">Could not set line type</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Set Line Type based on If sales Channel is Suddenlink, Org09 and Vendor is WWT" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Check Quote Contract for WH 09" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Comm - Suddenlink</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">World Wide Technology, Inc.</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">582</RHSValue>
		</Condition>
		<Action name="Set WWT OEtoPO-Pick-Ship-Invoice Line Type" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">WWT Pick-Ship-Invoice</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- IF THERE IS A PROJECT AND THERE ARE CONFIG SETS, BUILD A FANCY TASK NAME -->
<Rule name="IF there is a Project and there are config sets, build a new task name per config set" class="LINE" executeOnReprocess="N">
	<ConditionSet name="If Project is populated, and wsold.attribute17 is a master config" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">M%</RHSValue>
		</Condition>
		<Action name="Get Master number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">M</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If Project is populated, and wsold.attribute17 is a config item" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">C%</RHSValue>
		</Condition>
		<Action name="Get Config number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">C</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a master/config number was found" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">Catholic Healthcare West</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SUBINVENTORY</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">CHW</RHSValue>
		</Condition>
		<Action name="build config-specific task name" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CUSTOMER_PO_NUMBER</Parameter>
			<Parameter name="field2" valueType="STATIC">-</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a master/config number was found and this is Catholic Healthcare West" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Catholic Healthcare West</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SUBINVENTORY</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">CHW</RHSValue>
		</Condition>
		<Action name="build config-specific task name" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/HEADER_ID</Parameter>
			<Parameter name="field2" valueType="STATIC">-</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--  ADD A TASK WHEN NECESSARY -->
<Rule name="Add a task when necessary" class="LINE" executeOnReprocess="N">
	<ConditionSet name="If Project is populated, and this is a master/config item" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="add Task" class="createTask">
			<Parameter name="taskName" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="projectName" valueType="REFERENCE">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			<Parameter name="serviceTypeCode" valueType="STATIC">Field Work</Parameter>
			<ExceptionHandler type="ERROR">Could not add Task</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Else there is a project and it's not Catholic Healthcare West" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">Catholic Healthcare West</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SUBINVENTORY</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="STATIC">CHW</RHSValue>
		</Condition>
		<Action name="add Task using just the customer po number" class="createTask">
			<Parameter name="taskName" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CUSTOMER_PO_NUMBER</Parameter>
			<Parameter name="projectName" valueType="REFERENCE">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			<Parameter name="serviceTypeCode" valueType="STATIC">Field Work</Parameter>
			<ExceptionHandler type="ERROR">Could not add Task</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Else there is a project and it's Catholic Healthcare West" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Catholic Healthcare West</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SUBINVENTORY</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">CHW</RHSValue>
		</Condition>
		<Action name="add Task using just the customer po number" class="createTask">
			<Parameter name="taskName" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/HEADER_ID</Parameter>
			<Parameter name="projectName" valueType="REFERENCE">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			<Parameter name="serviceTypeCode" valueType="STATIC">Field Work</Parameter>
			<ExceptionHandler type="ERROR">Could not add Task</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--  OVERRIDE TASK WHEN PROJECT NAME FLAG EQUALS Y -->
<!--  PROJECT NAME FLAG IS SET IN PRE-PROCESS RULE -->
<Rule name="Override task when flag equals Y and build a fancy name for Mx/Cx items" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Override task when flag equals Y" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">M%</RHSValue>
		</Condition>
		<Action name="Get Master number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">M</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If Project is populated, and wsold.attribute17 is a config item" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROJECT</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">C%</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Get Config number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">C</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a master/config number was found" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="build config-specific task name" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/HEADER_ID</Parameter>
			<Parameter name="field2" valueType="STATIC">-</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="add Task using the stg header id" class="createTask">
			<Parameter name="taskName" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="projectName" valueType="REFERENCE">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			<Parameter name="serviceTypeCode" valueType="STATIC">Field Work</Parameter>
			<ExceptionHandler type="ERROR">Could not add Task</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Else this is a standalone item, Override task when flag equals Y" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="add Task using the stg header id" class="createTask">
			<Parameter name="taskName" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/HEADER_ID</Parameter>
			<Parameter name="projectName" valueType="REFERENCE">WWT_STG_ORDER_LINES/PROJECT</Parameter>
			<Parameter name="serviceTypeCode" valueType="STATIC">Field Work</Parameter>
			<ExceptionHandler type="ERROR">Could not add Task</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- SET SHIP SET FOR ALL MX CX LINES -->
<Rule name="If line is MX or CX then set ship set to 'X'" class="LINE" executeOnReprocess="N">
	<ConditionSet name="If line is MX" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">M%</RHSValue>
		</Condition>
		<Action name="Get Master number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">M</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If line is CX" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">C%</RHSValue>
		</Condition>
		<Action name="Get Config number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">C</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a master/config number was found" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Set Ship Set" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_SET</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- CREATE UNIQUE PART#S FOR ORG 06 AVNET AND CISCO MAINTENANCE ORDERS     -->
<Rule name="Create Unique Part#s for Org 06 or 26 for Avnet and Cisco Maintenance Orders" class="LINE" executeOnReprocess="N">
	<ConditionSet name="IF Org 06 or 26" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">247,375</RHSValue>
		</Condition>
		<Action name="UPPER Vendor Name" class="fieldToUpperCase">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<ExceptionHandler type="WARN">could not UPPER(VENDOR NAME)</ExceptionHandler>
		</Action>
		<!--REMOVE THE SPACES FROM THE CUSTOMER PO#  
		Don't know it is a Maint order unil the lines and I didn't want to remove the spaces at the header for every Qsys order - so doing it for each line on the Maint order...-->
		<Action name="Remove sapces from the PO#" class="searchAndReplace">			
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CUSTOMER_PO_NUMBER</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>					
			<Parameter name="searchString" valueType="STATIC"> </Parameter>
			<Parameter name="replaceString" valueType="STATIC"></Parameter>
			<ExceptionHandler type="WARN">Search and Replace failed for PO#.</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="IF Org 06 or 26 and Vendor is Avnet" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">247,375</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">AVNET.*</RHSValue>
		</Condition>
		<Action name="Copy Segment2 to Vendor SKU for Outbound EDI PO Creation" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE6</Parameter>
			<Parameter name="overWrite" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>				
		<Action name="Increment the counter" class="arithmetic">
			<Parameter name="LHS" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="operator" valueType="STATIC">+</Parameter>
			<Parameter name="RHS" valueType="STATIC">1</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="numericType" valueType="STATIC">Int</Parameter>
			<ExceptionHandler type="WARN">Could not increment line number</ExceptionHandler>		
		</Action>
		<Action name="Build Unique MO Part#" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
			<Parameter name="field2" valueType="STATIC">~</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="field4" valueType="STATIC">~</Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>	
			<Parameter name="maxLength" valueType="STATIC">25</Parameter>			
			<ExceptionHandler type="WARN">Could not build unique part number</ExceptionHandler>	
		</Action>
		<!--NEED TO CLEAN THE PART NUMBER AGAIN BEFORE AUTO-CREATING-->
		<Action name="Clean Part Number" class="cleanPartNumber">	
			<ExceptionHandler type="WARN">Could not strip out invalid characters in the Part Number</ExceptionHandler>	
		</Action>		
		<Action name="Auto-create Item" class="createItem">
			<Parameter name="destinationOrgs" valueType="STATIC">WWT_32</Parameter>
			<Parameter name="productCode" valueType="STATIC">HW</Parameter>
			<ExceptionHandler type="WARN">Could not auto-create item</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="IF Org 06 or 26 and Vendor is CISCO" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">247,375</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">CISCO.*</RHSValue>
		</Condition>
		<Action name="Copy Segment2 to Vendor SKU for Outbound EDI PO Creation" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE6</Parameter>
			<Parameter name="overWrite" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>				
		<Action name="Increment the counter" class="arithmetic">
			<Parameter name="LHS" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="operator" valueType="STATIC">+</Parameter>
			<Parameter name="RHS" valueType="STATIC">1</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="numericType" valueType="STATIC">Int</Parameter>
			<ExceptionHandler type="WARN">Could not increment line number</ExceptionHandler>		
		</Action>
		<Action name="Build Unique MO Part#" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
			<Parameter name="field2" valueType="STATIC">~</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar1</Parameter>
			<Parameter name="field4" valueType="STATIC">~</Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>	
			<Parameter name="maxLength" valueType="STATIC">25</Parameter>			
			<ExceptionHandler type="WARN">Could not build unique part number</ExceptionHandler>	
		</Action>
		<!--NEED TO CLEAN THE PART NUMBER AGAIN BEFORE AUTO-CREATING-->
		<Action name="Clean Part Number" class="cleanPartNumber">	
			<ExceptionHandler type="WARN">Could not strip out invalid characters in the Part Number</ExceptionHandler>	
		</Action>		
		<Action name="Auto-create Item" class="createItem">
			<Parameter name="destinationOrgs" valueType="STATIC">WWT_32</Parameter>
			<Parameter name="productCode" valueType="STATIC">HW</Parameter>
			<ExceptionHandler type="WARN">Could not auto-create item</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule> 

<!-- NULL OUT VENDOR NAME WHEN ORDER TYPE IS WWT -->
<Rule name="Null Vendor Name when Stock Shipment" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Check for Stock Shipment" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">WWT Stock Shipment,Telco Stock Shipment</RHSValue>
		</Condition>
		<Action name="NULL Vendor Name" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for State Farm" class="LINE" executeOnReprocess="N">
	<ConditionSet name="State Farm Description" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">COMM - State Farm</RHSValue>
		</Condition>
		<Action name="Map additional description to customer_item_description" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/ATTRIBUTE12</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE10</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
		<Action name="null out additional description" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE12</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
	<ConditionSet name="State Farm Config" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">COMM - State Farm</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">M1</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/ATTRIBUTE11</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Write an error to OCU" class="recordException">			
			<Parameter name="exceptionType" valueType="STATIC">ERROR</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">This State Farm order requires the Customer Part# DFF to be populated for M1 config lines.</Parameter>			
		</Action>
	</ConditionSet>		
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for NASA SEWP & Netcents" class="LINE" executeOnReprocess="N">
	<ConditionSet name="NASA SEWP & Netcents" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/AGREEMENT</LHSValue> 
			<Operator>IN</Operator> 
			<RHSValue valueType="LOOKUP">NASA_SEWP_AND_NETCENTS_AGREEMENT</RHSValue>
		</Condition>
		<Action name="Map CLIN# into the Customer Part# (attribute11)" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE16</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE11</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>	

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for Herman Miller" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Herman Miller, Inc." exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Herman Miller, Inc.</RHSValue>
		</Condition>
		<Action name="Set Vendor PO Site Code" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">PO TO(HMILLER)</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for Maintenance Order Renewal" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Maintenance Order Renewal when additional comments is not null" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_ATTRIBUTE17</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/ATTRIBUTE12</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Build Additional Information Attribute for Sales Order line - appending after additional comments" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_LINES/ATTRIBUTE12</Parameter>
			<Parameter name="field2" valueType="STATIC">|</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE17</Parameter>
			<Parameter name="field4" valueType="STATIC">|</Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE19</Parameter>
			<Parameter name="field6" valueType="STATIC">|</Parameter>
			<Parameter name="field7" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE20</Parameter>
			<Parameter name="field8" valueType="STATIC">|</Parameter>
			<Parameter name="field9" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE18</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE12</Parameter>
			<Parameter name="maxLength" valueType="STATIC">240</Parameter>
			<ExceptionHandler type="WARN">Could Not Build Additional Information attribute for Sales Order line</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Maintenance Order Renewal when additional comments is null" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_ATTRIBUTE17</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/ATTRIBUTE12</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Build Additional Information Attribute for Sales Order line" class="concatenateFields">
			<Parameter name="field1" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE17</Parameter>
			<Parameter name="field2" valueType="STATIC">|</Parameter>
			<Parameter name="field3" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE19</Parameter>
			<Parameter name="field4" valueType="STATIC">|</Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE20</Parameter>
			<Parameter name="field6" valueType="STATIC">|</Parameter>
			<Parameter name="field7" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_ATTRIBUTE18</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE12</Parameter>
			<Parameter name="maxLength" valueType="STATIC">240</Parameter>
			<ExceptionHandler type="WARN">Could Not Build Additional Information attribute for Sales Order line</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS ALASKA - PHASE 3 IPT-->
<Rule name="Custom line-level field mappings for ALASKA - PHASE 3" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set Line Type for Alaska -  Phase 3 IPT" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Alaska - Phase 3 IPT</RHSValue>
		</Condition>
		<Action name="Set Line Type" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">WWT Drop Ship-No Invoice</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>


<!-- LINE LEVEL CUSTOM MAPPINGS STATE OF MISSOURI-->
<Rule name="Custom line-level field mappings for State of Mo" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Check for State of Missouri Quote Contract" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Check for Manufacturer ID in Oracle" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getERPManufacturerByIDOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar6</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Create item for SOM" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar6</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Create item" class="createItem">
			<Parameter name="destinationOrgs" valueType="STATIC">WWT_18</Parameter>
			<Parameter name="productCode" valueType="STATIC">HW</Parameter>
			<ExceptionHandler type="WARN">Could not auto-create item</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Raise Exception if Manufacturer ID does not exit in Oracle" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/tempVar2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar6</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Write an error to OCU" class="recordException">
			<Parameter name="exceptionType" valueType="STATIC">ERROR</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">Cannot auto-create the item because the Manufacturer ID does not exist in Oracle.</Parameter>
		</Action>
	</ConditionSet>
</Rule>

<!-- CUSTOM LINE MAPPING FOR STATE OF MISSOURI -->
<Rule name="Custom line mapping for SOM" class="LINE" executeOnReprocess="N">
	<ConditionSet name="If SOM salesrep equals SOM - Jones State then set flow status to Booked" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">SOM_SALESREP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">SOM_INVENTORY_ITEMS</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">SOM_LINE_TYPE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for XO Communications" class="LINE" executeOnReprocess="N">
	<ConditionSet name="XO Communications" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">XO Communications, Inc.</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Tech Data Corporation</RHSValue>
		</Condition>
		<Action name="Set Vendor PO Site Code" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">PO EDI XO COMM</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS -->
<Rule name="Custom line-level field mappings for Avnet Access" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Avnet Access Division vendor name change" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Avnet Technology Solutions, Access Division</RHSValue>
		</Condition>
		<Action name="Set Vendor Name" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">Avnet Technology Solutions</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Avnet Technology Solutions vendor name change" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">WWT - Avnet Technology Solutions</RHSValue>
		</Condition>
		<Action name="Set Vendor Name" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">Avnet Technology Solutions</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule> 

<!-- LINE LEVEL CUSTOM MAPPINGS for JPMC Netfresh-->
<Rule name="JPMC Custom line-level field mappings for setting line type" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set line type" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_SALESREP</RHSValue>
		</Condition>
		<Action name="Set Line Type" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">JPMC_LINE_TYPE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS for JPMC -->
<Rule name="JPMC Custom line-level field mappings for JPMC Big Deal Number" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set line type" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_CUSTOMER_NAME</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_VENDOR_NAME</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_ORG_ID</RHSValue>
		</Condition>
		<Action name="Set JPMC Big Deal Number (LINES DFF ATTRIBUTE16)" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">JPMC_BIG_DEAL_NO</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE16</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS for Chevron -->
<Rule name="Chevron Custom line-level field mappings for Chevron Big Deal Number" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set line type" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">CHEVRON_CUSTOMER_NAME</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">CHEVRON_VENDOR_NAME</RHSValue>
		</Condition>
		<Action name="Set JPMC Big Deal Number (LINES DFF ATTRIBUTE16)" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CHEVRON_BIG_DEAL_NO</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE16</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS DSH-->
<Rule name="DSH Custom line-level field mappings for setting Price List" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set Price List" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DSH Global CFI - GPU</RHSValue>
		</Condition>
		<Action name="Lookup Price List and set at line" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">DSHGetPriceListFromEstoreItemOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/PRICE_LIST</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Copy Price List to Header" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/PRICE_LIST</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/PRICE_LIST</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- CHECK LOOKUP WWT_QSYS_DISALLOWED_SUBINVENTORIES TO SEE IF THIS ORDER IS USING A SUBINVENTORY THAT IS NOT ALLOWED -->
<Rule name="Check lookup WWT_QSYS_DISALLOWED_SUBINVENTORIES to see if this order is using a subinventory that is not allowed" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Check lookup WWT_QSYS_DISALLOWED_SUBINVENTORIES to see if this is a disallowed subinventory" exitOnSuccess="N">
		<Action name="Check lookup WWT_QSYS_DISALLOWED_SUBINVENTORIES" class="simpleLookup">
			<Parameter name="lookupType" valueType="STATIC">WWT_QSYS_DISALLOWED_SUBINVENTORIES</Parameter>
			<Parameter name="attribute1" valueType="REFERENCE">WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</Parameter>
			<Parameter name="attribute2" valueType="REFERENCE">WWT_STG_ORDER_LINES/SUBINVENTORY</Parameter>
			<Parameter name="returnColumn1" valueType="STATIC">ATTRIBUTE2</Parameter>
			<Parameter name="targetElement1" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar7</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If tempVar is not null then fail order to OCU due to disallowed subinventory" exitOnSuccess="Y">		
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar7</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Write an error to OCU" class="recordException">			
			<Parameter name="exceptionType" valueType="STATIC">ERROR</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">Invalid subinventory, please select a different subinventory.</Parameter>			
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS DOJ-Toner -->
<Rule name="DOJ-Toner custom line-level field mappings for vendor site defaults" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set vendor site for Synnex" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DOJ Toner</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Synnex Information Technologies</RHSValue>
		</Condition>
		<Action name="Set Synnex site to PO TO DOJ - FED" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">PO TO DOJ - FED</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Set vendor site for Ricoh" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DOJ Toner</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Ricoh Americas Corporation</RHSValue>
		</Condition>
		<Action name="Set Ricoh site to PO TO" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">PO TO</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Null Vendor Site for SEWPZ Part Number" exitOnSuccess="N">
		<Condition>
		    <LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DOJ Toner</RHSValue>
		</Condition>
		<Condition>	
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">SEWPZ</RHSValue>
		</Condition>
		<Action name="NULL Vendor Name" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>	
		<Action name="NULL Vendor Site" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- NULL OUT SHIP SET WHEN SUBINVENTORY IS CHW -->
<Rule name="Null out Ship Set when Subinventory is CHW" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Null out Ship Set when Subinventory is CHW" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SUBINVENTORY</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">CHW</RHSValue>
		</Condition>
		<Action name="Null out Ship Set" class="assignment">
			 <Parameter name="sourceElement" valueType="STATIC"></Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_SET</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM MAPPINGS FOR GSA -->
<Rule name="Override vendor and set PO site for GSA quote contracts" class="LINE" executeOnReprocess="N">
	<ConditionSet name="WGNA GSA Schedule vendor and site override" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">WGNA GSA Schedule</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="STATIC">Cisco Systems Inc,RSA Security Inc.</RHSValue>
		</Condition>
		<Action name="Set vendor" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_NAME_1</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set vendor site" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_SITE_CODE_1</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Carahsoft Technology Corp. vendor and site override" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Carahsoft Technology Corp. - F5</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">VMware, Inc.</RHSValue>
		</Condition>
		<Action name="Set vendor" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_NAME_2</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set vendor site" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_SITE_CODE_2</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="GSA vendor and site override" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">GSA</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">VENDOR_NAME_SPA_ACCT</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE16</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">SPA_ACCOUNT</RHSValue>
		</Condition>
		<Action name="Set vendor" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_NAME_3</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_NAME</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set vendor site" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">GSA_VENDOR_SITE_CODE_3</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>
	
<!-- UPMC CUSTOM RULE - GET UNSPSC CODES -->
<Rule name="Get UNSPSC from ETIL for UPMC" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Get UNSPSC from ETIL for UPMC" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Comm - UPMC</RHSValue>
		</Condition>
		<Action name="Set line DFF context" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">UPMC</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/CONTEXT</Parameter>			
			<ExceptionHandler type="ERROR">Error setting line DFF context</ExceptionHandler>
		</Action>
		<Action name="Get UNSPSC" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getUNSPSCfromETIL</Parameter>
			<Parameter name="dbName" valueType="STATIC">REPOS</Parameter>			
			<Parameter name="actionOnMultiple" valueType="STATIC">FIRST</Parameter>
			<Parameter name="overWrite" valueType="STATIC">Y</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE21</Parameter>
			<ExceptionHandler type="WARN">Error retrieving UNSPSC code</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>   
 
<!-- USING THIS FOR UNITED AIRLINES AND GRABBING CUSTOMER PART NUMBER -->
<Rule name="Populating customer part number in line DFF for United Airlines" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Populating customer part number in line DFF for United Airlines" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">UNITED_AIRLINE_SALESREP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">UA_SEGMENT4</RHSValue>
		</Condition>
		<Action name="Get customer part number." class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">unitedAirlineCustPartNumOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="actionOnMultiple" valueType="STATIC">ERROR</Parameter>
			<ExceptionHandler type="ERROR">Error getting customer part number for United Airlines.</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

  
  <!-- LINE LEVEL CUSTOM MAPPINGS PGE Vendor & Vendor Site Default -->
<Rule name="Custom line-level field mappings for PGE Vendor & Vendor Site" class="LINE" executeOnReprocess="N">
	<ConditionSet name="PGE " exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue> 
			<Operator>=</Operator> 
			<RHSValue valueType="STATIC">Comm - PGE</RHSValue> 
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue> 
			<Operator>LIKE</Operator> 
			<RHSValue valueType="STATIC">CON%</RHSValue> 
			</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">Cisco_Vendor</RHSValue>
		</Condition>
		<Action name="Set Vendor PO Site Code" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CISCO_VENDOR_SITE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL CUSTOM Mapping for PGE Vendor PO TO SITE Default -->
<Rule name="Custom line-level field mappings for PGE Vendor & Vendor Site MIXED ORDERS" class="LINE" executeOnReprocess="N">
	<ConditionSet name="PGE Mixed Order Defaults" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue> 
			<Operator>=</Operator> 
			<RHSValue valueType="STATIC">Comm - PGE</RHSValue> 
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
			<Operator>=</Operator> 
			<RHSValue valueType="STATIC">WWT MIXED</RHSValue> 
			</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">Cisco_Vendor</RHSValue>
		</Condition>
		<Action name="Set Vendor PO Site Code" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CISCO_VENDOR_SITE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/VENDOR_SITE_CODE</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>


<Rule name="Set line type to WWT OEtoPO-Pick-Ship-Inv Hold for United Healthgroup RFQ orders" class="LINE" executeOnReprocess="N">
	<ConditionSet name="If sales rep is'Comm - United Healthcare',change line type to invoice hold " exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">UHG_SALESREP</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">UHG_RFQ_LINE_TYPE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- Push Promised Date and Scheduled Ship Date out 21 Days from Booking Date  -->
<Rule name="Push Promised Date and Scheduled Ship Date out 21 Days from Booking Date" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Push Promised Date and Scheduled Ship Date out 21 Days from Booking Date" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Sprint - Cisco</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/PROMISE_DATE</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/SCHEDULE_SHIP_DATE</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<!--<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE33</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE51</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition> -->
		<!--<Action name="Get Sysdate" class="dateFormat">
			<Parameter name="newPattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE33</Parameter>
			<ExceptionHandler type="WARN">Could not set date forward</ExceptionHandler>
		</Action> -->
		
		<!--<Action name="Get Sysdate" class="dateFormat">
			<Parameter name="newPattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/REQUEST_DATE</Parameter>
			<ExceptionHandler type="WARN">Could not set date format</ExceptionHandler>
		</Action> -->
		
		<Action name="Calculate Promise Date" class = "calcFutureDate">
		  	<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CREATION_DATE</Parameter>		
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/PROMISE_DATE</Parameter>
			<Parameter name="sourceDatePattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<Parameter name="daysForward" valueType="STATIC">21</Parameter>
			<Parameter name="businessDaysOnly" valueType="STATIC">Y</Parameter>
			<Parameter name="allowEndOnWeekend" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="WARN">Could not calculate Request Date</ExceptionHandler>
		 </Action>
		 <Action name="Calculate Request Date" class = "calcFutureDate">
		  	<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/CREATION_DATE</Parameter>		
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SCHEDULE_SHIP_DATE</Parameter>
			<Parameter name="sourceDatePattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<Parameter name="daysForward" valueType="STATIC">21</Parameter>
			<Parameter name="businessDaysOnly" valueType="STATIC">Y</Parameter>
			<Parameter name="allowEndOnWeekend" valueType="STATIC">N</Parameter>
			<ExceptionHandler type="WARN">Could not calculate Request Date</ExceptionHandler>
		 </Action>
		<!--<Action name="Calculate Scheduled Ship Date" class = "calcFutureDate">
		  	<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/CREATION_DATE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE33</Parameter>
			<Parameter name="daysForward" valueType="STATIC">21</Parameter>
			<Parameter name="businessDaysOnly" valueType="STATIC">Y</Parameter>
			<Parameter name="sourceDatePattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<ExceptionHandler type="WARN">Could not calculate Schedule Ship Date</ExceptionHandler>
		 </Action>
		 <Action name="Calculate Promised Date" class = "calcFutureDate">
		  	<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/CREATION_DATE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE51</Parameter>
			<Parameter name="daysForward" valueType="STATIC">21</Parameter>
			<Parameter name="businessDaysOnly" valueType="STATIC">Y</Parameter>
			<Parameter name="sourceDatePattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<ExceptionHandler type="WARN">Could not calculate Promised Date</ExceptionHandler>
		 </Action> -->
	</ConditionSet>
</Rule>

<!-- Default SPA# -->
<Rule name="Set Custom SPA#" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Set SPA#" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">SALES_CHANNEL_SPA_NUMBER</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/VENDOR_NAME</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">VENDOR_FOR_SPA_NUMBER</RHSValue>
		</Condition>
		<Action name="Set SPA#" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">SPA_NUMBER</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE16</Parameter>
			<ExceptionHandler type="WARN">Error Setting SPA#</ExceptionHandler>	
		</Action>
	</ConditionSet>		
</Rule>

<Rule name="Set Transmit to Vendor Flag for Comcast" class="LINE" executeOnReprocess="N">
 <ConditionSet name="Check contract type and master component" exitOnSuccess="Y">
 <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/QUOTE_CONTRACT</LHSValue> 
	<Operator>IN</Operator> 
	<RHSValue valueType="LOOKUP">CMST_QUOTE_CONTRACT</RHSValue>
  </Condition>
  <Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
			<Operator>NOT IN</Operator> 
			<RHSValue valueType="LOOKUP">CMST_ORDER_TYPE</RHSValue>
	</Condition>
  <Condition>
	<LHSValue>WWT_STG_ORDER_LINES/persistedOTOSTempVariables/configTempVar</LHSValue>
	<Operator>IN</Operator> 
	<RHSValue valueType="LOOKUP">CMST_CONFIG_TYPE</RHSValue>
	</Condition>
	 <Condition>
	<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue> 
	<Operator>=</Operator> 
	<RHSValue valueType="STATIC">QSYS</RHSValue>
  </Condition>
	<Action name="Set Vendor Transmit Flag to N for master" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">N</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE48</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- Wyndham - Ticket # to Note for Vendor -->
<Rule name="Set Vendor Name with Ticket #" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Conditions" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Wyndham Worldwide Operations, Inc.</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Concatenate Note to Vendor" class="concatenateFields">
			<Parameter name="field1" valueType="STATIC">Please include Ticket# </Parameter>
			<Parameter name="field2" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE21</Parameter>
			<Parameter name="field3" valueType="STATIC"> on the shipping label</Parameter>
			<Parameter name="field4" valueType="STATIC"> - </Parameter>
			<Parameter name="field5" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE26</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE26</Parameter>
			<Parameter name="maxLength" valueType="STATIC">2000</Parameter>
			<ExceptionHandler type="WARN">Note to Vendor Not Set Correctly</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Call apps.OM_QSYS_MAPPING_UTIL.map_erp_mfg_to_ph_mfg" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Call apps.OM_QSYS_MAPPING_UTIL.map_erp_mfg_to_ph_mfg" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
    <!-- CALL apps.OM_QSYS_MAPPING_UTIL.map_erp_ids_to_ph_ids  -->
    <!-- Parameters 1 - 3 Are the MFG name and ERP acct ID-->
    <!-- Parameters 4- 5 are return error code and error message from the calling pl/sql   -->
		<Action name="Call wrapper procedure that will call Partner Hub API" class="genericDBProcedureCall">
			<Parameter name="schemaName" valueType="STATIC">APPS</Parameter>
			<Parameter name="packageName" valueType="STATIC">WWT_OM_PARTNER_MAPPING</Parameter>
			<Parameter name="procedureName" valueType="STATIC">map_erp_mfg_to_ph_mfg</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="parameter1" valueType="STATIC">P_ORIG_HEADER_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter2" valueType="STATIC">P_MFG_NAME,VARCHAR2,IN,WWT_STG_ORDER_LINES/MANUFACTURER_NAME,REFERENCE,</Parameter>
			<Parameter name="parameter3" valueType="STATIC">P_MFG_ID,VARCHAR2,IN,WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_1,REFERENCE,</Parameter>
			<Parameter name="parameter4" valueType="STATIC">P_LAST_UPDATED_BY,NUMBER,IN,WWT_STG_ORDER_HEADERS/LAST_UPDATED_BY,REFERENCE,</Parameter>
			<Parameter name="parameter5" valueType="STATIC">X_RETCODE,NUMBER,OUT,,,WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode</Parameter>
			<Parameter name="parameter6" valueType="STATIC">X_ERRBUFF,VARCHAR2,OUT,,,WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/ErrorMsg</Parameter>
			<ExceptionHandler type="ERROR">Could not make call to apps.WWT_OM_PARTNER_MAPPING.map_erp_mfg_to_ph_mfg</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Send Internal Email if error is encountered from apps.OM_QSYS_MAPPING_UTIL.map_erp_mfg_to_ph_mfg" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Send Internal Email if error is encountered" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">ORA_ERROR_CODES</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
		<Action name="Send notification when error" class="sendInternalEmail">
			<Parameter name="subject" valueType="STATIC">Error returned from calling WWT_OM_PARTNER_MAPPING.map_erp_mfg_to_ph_mfg</Parameter>
			<Parameter name="toList" valueType="STATIC">brenda.dupont@wwt.com</Parameter>
			<Parameter name="body" valueType="STATIC">
       Orig Header ID: %WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID%
       
       Error Code Returned from WWT_OM_PARTNER_MAPPING.map_erp_mfg_to_ph_mfg: %WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode%:

       Error Message Returned from WWT_OM_PARTNER_MAPPING.map_erp_mfg_to_ph_mfg: %WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/ErrorMsg%
      </Parameter>
			<ExceptionHandler type="WARN">Could not send email</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule> 

<!-- CUSTOM LINE MAPPING FOR Emerson Lab Services Part Number -->
<Rule name="Custom line type mapping for Emerson" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set correct line type for Lab Services Part Number" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">EMERSON_SALESREP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">EMERSON_INVENTORY_ITEM</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">EMERSON_SEGMENT</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">EMERSON_LINE_TYPE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Warehouse" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">EMERSON_WAREHOUSE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Subinventory" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">EMERSON_SUBINVENTORY</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SUBINVENTORY</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- CUSTOM LINE MAPPING FOR Allstate Lab Services Part Number -->
<Rule name="Custom line type mapping for Allstate" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set correct line type for Lab Services Part Number" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">ALLSTATE_SALESREP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">ALLSTATE_INVENTORY_ITEM</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">ALLSTATE_SEGMENT</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">ALLSTATE_LINE_TYPE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Warehouse" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">ALLSTATE_WAREHOUSE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Subinventory" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">ALLSTATE_SUBINVENTORY</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SUBINVENTORY</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- Custom freight calculation for WIDEOPENWEST orders-->
<Rule name="Compare inbound part number to wwt lookup for WideOpenWest Finance" class="LINE" executeOnReprocess="Y" executeOnNewLine="Y">
	<ConditionSet name="Compare inbound part number to lookup list of part numbers" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">WideOpenWest Finance, LLC</RHSValue>
		</Condition>
		<Action name="Identify part on order and compare to lookup" class="simpleLookup">
			<Parameter name="lookupType" valueType="STATIC">WIDEOPENWEST_FINANCE_FREIGHT_CHARGES</Parameter>
			<Parameter name="attribute1" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
			<Parameter name="returnColumn1" valueType="STATIC">ATTRIBUTE1</Parameter>
			<Parameter name="targetElement1" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar1</Parameter>
			<ExceptionHandler type="WARN">Could not find part in lookup</ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Calculate line freight and add to header charges field" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar1</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Calculate total line selling price" class="arithmetic">
			<Parameter name="LHS" valueType="REFERENCE">WWT_STG_ORDER_LINES/UNIT_SELLING_PRICE</Parameter>
			<Parameter name="operator" valueType="STATIC">*</Parameter>
			<Parameter name="RHS" valueType="REFERENCE">WWT_STG_ORDER_LINES/ORDERED_QUANTITY</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<ExceptionHandler type="ERROR">Could not calculate total line selling price</ExceptionHandler>
		</Action>
		<Action name="Calculate line freight" class="arithmetic">
			<Parameter name="LHS" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar2</Parameter>
			<Parameter name="operator" valueType="STATIC">*</Parameter>
			<Parameter name="RHS" valueType="LOOKUP">WOW_FREIGHT_PERCENTAGE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/FREIGHT_CHARGES</Parameter>
			<ExceptionHandler type="ERROR">Could not calculate total line selling price</ExceptionHandler>
		</Action>
	</ConditionSet>	
</Rule>

<!-- CUSTOM LINE MAPPING FOR Suddenlink Lab Services Part Number -->
<Rule name="Custom line type mapping for Suddenlink" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Set correct line type for Lab Services Part Number" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">SUDDENLINK_SALESREP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">SUDDENLINK_INVENTORY_ITEM</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">SUDDENLINK_SEGMENT</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">SUDDENLINK_LINE_TYPE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Warehouse" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">SUDDENLINK_WAREHOUSE</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set Subinventory" class="assignment">
			 <Parameter name="sourceElement" valueType="LOOKUP">SUDDENLINK_SUBINVENTORY</Parameter>
			 <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SUBINVENTORY</Parameter>
			 <ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- Set Customer Part Number for Sprint - Cicso -->
<Rule name="Set Customer Part Number for Sprint - Cicso" class="LINE" executeOnReprocess="N">
    <ConditionSet name="Set Customer Part Number for Sprint - Cicso" exitOnSuccess="Y">
        <Condition>
            <LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
            <Operator>=</Operator>
            <RHSValue valueType="STATIC">Sprint - Cisco</RHSValue>
        </Condition>
        <Action name="Set Customer Item Number" class="assignment">
            <Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
            <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE11</Parameter>                                   
            <ExceptionHandler type="NONE"></ExceptionHandler>              
        </Action>
    </ConditionSet>
</Rule>

<!--CHECK FOR DROP SHIP INDICATOR-->
<Rule name="International Orders - New Quote System - Check for Drop Ship Indicator" class="LINE" executeOnReprocess="Y">	
	<ConditionSet name="Check for Drop Ship Indicator" exitOnSuccess="Y">
	<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
	<Action name="Check for Drop Ship Indicator" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getDropShipOrderIndicatorOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- SET SHIP SET FOR ALL MX CX LINES -->
<Rule name="International Orders - New Quote System - If line is MX or CX then set ship set to 'X'" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="If line is MX" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">M%</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</LHSValue>
			<Operator>NOT LIKE</Operator>
			<RHSValue valueType="STATIC">DROP_SHIP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Get Master number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">M</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If line is CX" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="STATIC">C%</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</LHSValue>
			<Operator>NOT LIKE</Operator>
			<RHSValue valueType="STATIC">DROP_SHIP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Get Config number" class="parseString">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/WWT_STG_ORDER_LINES_DFF/ATTRIBUTE17</Parameter>			
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="beginMarker" valueType="STATIC">C</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a master/config number was found" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Set Ship Set" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar3</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_SET</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="If a Drop Ship Line" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/tempVar4</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">DROP_SHIP</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/WWT_ATTRIBUTE35</LHSValue> <!--WWT_ATTRIBUTE35 is the International flag from New Quote system-->
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">Y</RHSValue>
		</Condition>
		<Action name="Set Ship Set" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC"></Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_SET</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- New Quote System - Business Process Mapping -->
<Rule name="WWT Business Process Mapping - New Quote System" class="LINE" executeOnReprocess="N">  
<ConditionSet name="WWT Bill and Hold Mapping" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for WWT Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_BILL_AND_HOLD</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Advance Bill and Hold Mapping - Special Buy to Order" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ADVANCE_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">WWT_SPECIAL_BUY_TO_ORDER</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_ADVANCE_BILL_AND_HOLD_SPECIAL_BUY_TO_ORDER</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Advance Bill and Hold Mapping - Special Drop Ship" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ADVANCE_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_SPECIAL_DROP_SHIP</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_ADVANCE_BILL_AND_HOLD_SPECIAL_DROP_SHIP</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="WWT Deferred Bill and Hold - Special Buy to Order" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_DEFERRED_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">WWT_SPECIAL_BUY_TO_ORDER</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_DEFERRED_BILL_AND_HOLD_SPECIAL_BUY</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="WWT Deferred Bill and Hold - Special Drop Ship" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_DEFERRED_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_SPECIAL_DROP_SHIP</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_DEFERRED_BILL_AND_HOLD_SPECIAL_DROP</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
</Rule>

<Rule name="Telco Business Process Mapping - New Quote System" class="LINE" executeOnReprocess="N">  
<ConditionSet name="Telco Bill and Hold Mapping" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for WWT Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_TELCO_BILL_AND_HOLD</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Telco Advance Bill and Hold Mapping - Special Buy to Order" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ADVANCE_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">TELCO_SPECIAL_BUY_TO_ORDER</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_TELCO_ADVANCE_BILL_AND_HOLD_SPECIAL_BUY_TO_ORDER</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Telco Advance Bill and Hold Mapping - Special Drop Ship" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ADVANCE_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_SPECIAL_DROP_SHIP</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_TELCO_ADVANCE_BILL_AND_HOLD_SPECIAL_DROP_SHIP</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Telco Deferred Bill and Hold - Special Buy to Order" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_DEFERRED_BILL_AND_HOLD</RHSValue> 
	</Condition>
		<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">TELCO_SPECIAL_BUY_TO_ORDER</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_TELCO_DEFERRED_BILL_AND_HOLD_SPECIAL_BUY</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="Telco Deferred Bill and Hold - Special Drop Ship" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_DEFERRED_BILL_AND_HOLD</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_SPECIAL_DROP_SHIP</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">TELCO_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_TELCO_DEFERRED_BILL_AND_HOLD_SPECIAL_DROP</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
</Rule>

<Rule name="WWT UK Business Process Mapping - New Quote System" class="LINE" executeOnReprocess="N">  
<ConditionSet name="WWT UK Advanced" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_UK_BUSINESS_PROCESS_TYPE</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">WWT_UK_SPECIAL_BUY_TO_ORDER</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_UK_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for WWT Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_UK_SPECIAL_BUY_TO_ORDER_LINE_TYPE</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
<ConditionSet name="WWT UK Deferred" exitOnSuccess="Y">
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">NEW_QSYS_SOURCE</RHSValue>
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE91</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_UK_BUSINESS_PROCESS_TYPE</RHSValue> 
	</Condition>
		<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
		<Operator>IN</Operator>
		<RHSValue valueType="LOOKUP">WWT_UK_SPECIAL_DROP_SHIP</RHSValue> 
	</Condition>
	<Condition>
		<LHSValue>WWT_STG_ORDER_HEADERS/ORG_ID</LHSValue> 
		<Operator>IN</Operator> 
		<RHSValue valueType="LOOKUP">WWT_UK_ORG_ID</RHSValue> 
	</Condition>
	<Action name="Set Line Type for Advance Bill and Hold" class="assignment">
		<Parameter name="sourceElement" valueType="LOOKUP">QSYS3_UK_SPECIAL_DROP_SHIP_LINE_TYPE</Parameter> 
		<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter> 
		<ExceptionHandler type="NONE" /> 
	</Action>
</ConditionSet>
</Rule>

<!--Custom rule for Walmart that will query attribute 8 from organization items and will populate on sales order line -->
<Rule name="Customer Line Level Mapping for Walmart" class="LINE" executeOnReprocess="N">
                <ConditionSet name="Retrieve Attribute8 - Customer ID from Organization Items" exitOnSuccess="N">
                                <Condition>
                                                <LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
                                                <Operator>=</Operator>
                                                <RHSValue valueType="STATIC">Wal-Mart Stores Inc.</RHSValue>
                                </Condition>
                                <Condition>
                                                <LHSValue>WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</LHSValue> 
                                                <Operator>=</Operator> 
                                                <RHSValue valueType="STATIC">3346</RHSValue> 
                                </Condition>
                                <Action name="Retrieve Attribute 8 - Customer ID" class="singleItemQuery">
                                                <Parameter name="sqlConstantName" valueType="STATIC">WalmartGetattribute8OTOSSQL</Parameter>
                                                <Parameter name="dbName" valueType="STATIC">ERP</Parameter>
                                                <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE11</Parameter>
                                                <ExceptionHandler type="WARN">Could not retrieve attribute8/customer id from organization items</ExceptionHandler>
                                </Action>
                </ConditionSet>
</Rule>

<!--Custom rule for Facebook that will query attr8 from master items and populate onto sales order line cust part # attr11 -->
<Rule name="Customer Line Level Mapping for Facebook" class="LINE" executeOnReprocess="Y">
    <ConditionSet name="Retrieve Attribute8 - Customer ID from Organization Items" exitOnSuccess="N">
        <Condition>
                   <LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
                   <Operator>LIKE</Operator>
                   <RHSValue valueType="STATIC">%Facebook%</RHSValue>
       </Condition>
       <Action name="Retrieve Attribute 8 - Customer ID" class="multiItemQuery">
                   <Parameter name="sqlConstantName" valueType="STATIC">grabCustomerPartNumberFromItemMasterOTOSSQL</Parameter>
                   <Parameter name="dbName" valueType="STATIC">ERP</Parameter>
				  <Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
                   <Parameter name="sourceElement2" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_3</Parameter>
                   <Parameter name="sourceElement3" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_1</Parameter>     
                   <Parameter name="sourceElement4" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</Parameter>
		          <ExceptionHandler type="ERROR">Item does not exist</ExceptionHandler>
       </Action>
	<Action name="Set Customer Part #" class="assignment">
                   <Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/persistedOTOSTempVariables/custpartnumber</Parameter>
                   <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/ATTRIBUTE11</Parameter>
				   <Parameter name="allowNullSet" valueType="STATIC">N</Parameter> 
                   <ExceptionHandler type="ERROR">Could not retrieve customer part number from item master</ExceptionHandler>				   
      </Action>
  </ConditionSet>
</Rule>


<!-- CHECK TO SEE IF ITEM IS NON-SHIPPABLE EXISTS ON PANERA BREAD ORDER -->
<Rule name="Customer Line Level Mapping for Panera Bread" class="LINE" executeOnReprocess="Y">
                <ConditionSet name="Check to see if item is non-shippable and if it is set line type" exitOnSuccess="Y">
                                <Condition>
                                                <LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
                                                <Operator>=</Operator>
                                                <RHSValue valueType="LOOKUP">PANERA_CUSTOMER_NAME</RHSValue>
                                </Condition>
       <Action name="Check to see if item is non-shippable" class="multiItemQuery">
            <Parameter name="sqlConstantName" valueType="STATIC">grabNonShippableItemOTOSSQL</Parameter>
            <Parameter name="dbName" valueType="STATIC">ERP</Parameter>
            <Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</Parameter>
            <Parameter name="sourceElement2" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</Parameter>
            <Parameter name="sourceElement3" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_1</Parameter>                      
        <ExceptionHandler type="NONE"></ExceptionHandler>
     </Action>
                </ConditionSet>
                <ConditionSet name="Set line type and org id for non-shippable item" exitOnSuccess="Y">
                    <Condition>
                                                <LHSValue>WWT_STG_ORDER_LINES/OTOSTempVariables/nonShippableFlag</LHSValue>
                                                <Operator>=</Operator>
                                                <RHSValue valueType="STATIC">Y</RHSValue>
                                </Condition>
                                                <Action name="Set Line Type" class="assignment">
                                                <Parameter name="sourceElement" valueType="LOOKUP">NON_SHIPPABLE_LINE_TYPE</Parameter>
                                                <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
                                                <ExceptionHandler type="NONE"></ExceptionHandler>              
                                    </Action>
                                                <Action name="Set ORG ID" class="assignment">
                                                <Parameter name="sourceElement" valueType="LOOKUP">PANERA_ORG_ID</Parameter>
                                                <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/SHIP_FROM_ORG_ID</Parameter>
                                                <ExceptionHandler type="NONE"></ExceptionHandler>              
                                    </Action>
                </ConditionSet>                              
</Rule>

<!-- Set Telco Line Type for Telco - Verizon sales channel -->
<Rule name="Set Line Type for Telco Verizon orders" class="LINE" executeOnReprocess="N">
    <ConditionSet name="Set Line Type for Telco Verizon Mixed Orders" exitOnSuccess="Y">
        <Condition>
            <LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
            <Operator>=</Operator>
            <RHSValue valueType="LOOKUP">Telco_Verizon_SalesChannel</RHSValue>
        </Condition>
                                <Condition>
            <LHSValue>WWT_STG_ORDER_HEADERS/ORDER_TYPE</LHSValue> 
            <Operator>=</Operator> 
            <RHSValue valueType="STATIC">Telco Mixed</RHSValue> 
        </Condition>
                                    <Action name="Set Line Type" class="assignment">
                                                <Parameter name="sourceElement" valueType="LOOKUP">Telco_Verizon_Line_Type</Parameter>
                                                <Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>
                                                <ExceptionHandler type="NONE"></ExceptionHandler>              
                                    </Action>
    </ConditionSet>
</Rule>

<!-- LINE LEVEL RULE For Federal DISA ESSII orders to set fourth segment, line type, and Header DFF values -->
<Rule name="Defaulting fourth segment, line type, and Header DFF values For Federal DISA ESSII Orders" class="LINE" executeOnReprocess="N">
	<ConditionSet name="Populating fourth segment, line type, and Header DFF values type for Federal DISA ESSII orders" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">DISA_SALESREP</RHSValue>
		</Condition>
	         <Action name="Set Line Type for Federal DISA ESSII orders" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">DISA_LINE_TYPE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>			
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	        <Action name="Set Segment4 for Federal DISA ESSII orders" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">DISA_FOURTH_SEGMENT</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_4</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
		<Action name="Set SDA Program Name - Attribute 81" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">DISA_SDA_PROGRAM_NAME</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE81</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
		<Action name="Set SDA Site - Attribute 82" class="assignment">
			<Parameter name="sourceElement" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/ATTRIBUTE5</Parameter>
			<Parameter name="targetElement"	valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE82</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>	
		</Action>
	</ConditionSet>
</Rule>

<!-- LINE LEVEL RULE For Cox Communications -->
<Rule name="Cox Communications Price Check" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Cox Communications - Get Oracle Price List Info" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">COX COMMUNICATIONS - CC DUKE DR</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Get inventory item id" class="singleItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getInventoryItemIDOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="actionOnMultiple" valueType="STATIC">FIRST</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/INVENTORY_ITEM_ID</Parameter>
			<ExceptionHandler type="ERROR">INVALID ITEM - Item does NOT exist on Item Master</ExceptionHandler>
		</Action>
		<Action name="Get Oracle Price List Value" class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getGenericOraclePriceListOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="actionOnMultiple" valueType="STATIC">FIRST</Parameter>
			<Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_HEADERS/ATTRIBUTE5</Parameter>
			<Parameter name="sourceElement2" valueType="REFERENCE">WWT_STG_ORDER_LINES/INVENTORY_ITEM_ID</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
	<ConditionSet name="Cox Communications - Price Check" exitOnSuccess="N">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">COX COMMUNICATIONS - CC DUKE DR</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NOT NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/persistedOTOSTempVariables/operand</LHSValue>
			<Operator>!=</Operator>
			<RHSValue valueType="REFERENCE">WWT_STG_ORDER_LINES/UNIT_SELLING_PRICE</RHSValue>
		</Condition>
		<Action name="Write an error to OCU" class="recordException">
			<Parameter name="exceptionType" valueType="STATIC">ERROR</Parameter>
			<Parameter name="exceptionMessage" valueType="STATIC">Price List doesn't Exist or Unit Selling Price does not match Oracle Price List part.  Please check</Parameter>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="COX Communications - Set Unit Selling Price to 0 when Price List is missing" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Cox Communications - Update Unit Selling Price if No Price list" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/CUSTOMER_NAME</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">COX COMMUNICATIONS - CC DUKE DR</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/ATTRIBUTE5</LHSValue>
			<Operator>IS NULL</Operator>
			<RHSValue valueType="STATIC"></RHSValue>
		</Condition>
		<Action name="Set Unit Selling Price to 0" class="assignment">
			<Parameter name="sourceElement" valueType="STATIC">0</Parameter>
			<Parameter name="targetElement" valueType="REFERENCE">WWT_STG_ORDER_LINES/UNIT_SELLING_PRICE</Parameter>                                        
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--Expense Line By Material Designator Check-->
<Rule name="Expense Line By Material Designator Check" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="Expense Line By Material Designator Check" exitOnSuccess="N">
		<Action name="Check for Expense Line by MD" class="multiItemQuery">
			<Parameter name="sqlConstantName" valueType="STATIC">getExpenseLineByMDOTOSSQL</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="actionOnMultiple" valueType="STATIC">FIRST</Parameter>
			<Parameter name="sourceElement1" valueType="REFERENCE">WWT_STG_ORDER_LINES/ATTRIBUTE13</Parameter>
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--Set line type for Credit Card line  -->
<Rule name="If Credit Card fee line is on order, set line type" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="If Credit Card fee exists on order, set line type" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_LINES/INVENTORY_ITEM_SEGMENT_2</LHSValue>
			<Operator>LIKE</Operator>
			<RHSValue valueType="LOOKUP">CREDIT_CARD_FEE</RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CREDIT_CARD_FEE_LINE_TYPE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>                                        
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!--Set Payload_ID for cXML to QSYS orders  -->
<Rule name="If order is cXML to QSYS order, then move payload to attribute46 in SHD" class="LINE" executeOnReprocess="Y">
	<ConditionSet name="If order is cXML to QSYS order, then move payload to attribute46 in SHD" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP"></RHSValue>
		</Condition>
		<Action name="Set line type" class="assignment">
			<Parameter name="sourceElement" valueType="LOOKUP">CREDIT_CARD_FEE_LINE_TYPE</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_LINES/LINE_TYPE</Parameter>                                        
			<ExceptionHandler type="NONE"></ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- ******************************** -->
<!-- ****** BEGIN POST-PROCESS ****** -->
<!-- ******************************** -->
	
<!-- JPMC Netfresh Bulk Orders set wwt_stg_order_headers_dff/attribute 32 = to sysdate -->
<Rule name="JPMC Netfresh Bulk Orders need to set wwt_stg_order_headers_dff/attribute 32 = to sysdate" class="POST-PROCESS" executeOnReprocess="N">
	<ConditionSet name="Set wwt_stg_order_headers_dff/attribute 32 = to sysdate" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/INVOICE_ADDRESS2</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_INVOICE_ADDRESS</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SALESREP</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="LOOKUP">JPMC_SALESREP</RHSValue>
		</Condition>
		<Action name="Set sysdate to temp variable" class="dateFormat">
			<!-- SYSDATE -->
			<Parameter name="newPattern" valueType="STATIC">dd-MMM-yyyy</Parameter>
			<Parameter name="targetElement" valueType="TARGET">WWT_STG_ORDER_HEADERS/WWT_STG_ORDER_HEADERS_DFF/ATTRIBUTE32</Parameter>
			<ExceptionHandler type="WARN">Could not set date format</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<!-- ******************************** -->
<!-- ****** BEGIN POST-PINWHEEL ****** -->
<!-- ******************************** -->

<Rule name="Call apps.WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids" class="POST-PINWHEEL" executeOnReprocess="Y">
	<ConditionSet name="Call apps.WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/STATUS</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">PROCESSED</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
    <!-- CALL apps.WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids  -->
    <!-- Parameters 1 - 8 Are the Customer names and their ERP acct IDs-->
    <!-- Parameters 9 - 10 are return error code and error message from the calling pl/sql   -->
		<Action name="Call wrapper procedure that will call Partner Hub API" class="genericDBProcedureCall">
			<Parameter name="schemaName" valueType="STATIC">APPS</Parameter>
			<Parameter name="packageName" valueType="STATIC">WWT_OM_PARTNER_MAPPING</Parameter>
			<Parameter name="procedureName" valueType="STATIC">map_erp_ids_to_ph_ids</Parameter>
			<Parameter name="dbName" valueType="STATIC">ERP</Parameter>
			<Parameter name="parameter1" valueType="STATIC">P_CUST_NAME,VARCHAR2,IN,WWT_STG_ORDER_HEADERS/CUSTOMER_NAME,REFERENCE,</Parameter>
			<Parameter name="parameter2" valueType="STATIC">P_CUST_NAME_ACCT_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/CUSTOMER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter3" valueType="STATIC">P_INVOICE_NAME,VARCHAR2,IN,WWT_STG_ORDER_HEADERS/INVOICE_CUSTOMER,REFERENCE,</Parameter>
			<Parameter name="parameter4" valueType="STATIC">P_INVOICE_NAME_ACCT_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/INVOICE_CUSTOMER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter5" valueType="STATIC">P_SHIP_TO_NAME,VARCHAR2,IN,WWT_STG_ORDER_HEADERS/SHIP_TO_CUSTOMER,REFERENCE,</Parameter>
			<Parameter name="parameter6" valueType="STATIC">P_SHIP_TO_ACCT_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/SHIP_TO_CUSTOMER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter7" valueType="STATIC">P_END_CUST_NAME,VARCHAR2,IN,WWT_STG_ORDER_HEADERS/END_CUSTOMER_NAME,REFERENCE,</Parameter>
			<Parameter name="parameter8" valueType="STATIC">P_END_CUST_NAME_ACCT_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/END_CUSTOMER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter9" valueType="STATIC">P_ORDER_SOURCE,VARCHAR2,IN,WWT_STG_ORDER_HEADERS/SOURCE,REFERENCE,</Parameter>
			<Parameter name="parameter10" valueType="STATIC">P_ORIG_HEADER_ID,NUMBER,IN,WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID,REFERENCE,</Parameter>
			<Parameter name="parameter11" valueType="STATIC">P_LAST_UPDATED_BY,NUMBER,IN,WWT_STG_ORDER_HEADERS/LAST_UPDATED_BY,REFERENCE,</Parameter>
			<Parameter name="parameter12" valueType="STATIC">X_RETCODE,NUMBER,OUT,,,WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode</Parameter>
			<Parameter name="parameter13" valueType="STATIC">X_ERRBUFF,VARCHAR2,OUT,,,WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/ErrorMsg</Parameter>
			<ExceptionHandler type="ERROR">Could not make call to apps.WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>

<Rule name="Send Internal Email if error is encountered from apps.WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids" class="POST-PINWHEEL" executeOnReprocess="Y">
	<ConditionSet name="Send Internal Email if error is encountered" exitOnSuccess="Y">
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode</LHSValue>
			<Operator>IN</Operator>
			<RHSValue valueType="LOOKUP">ORA_ERROR_CODES</RHSValue>
		</Condition>
		<Condition>
			<LHSValue>WWT_STG_ORDER_HEADERS/SOURCE</LHSValue>
			<Operator>=</Operator>
			<RHSValue valueType="STATIC">QSYS_3</RHSValue>
		</Condition>
		<Action name="Send notification when error" class="sendInternalEmail">
			<Parameter name="subject" valueType="STATIC">Error returned from calling WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids</Parameter>
			<Parameter name="toList" valueType="LOOKUP">CUST_MAP_DIST_LIST</Parameter>
			<Parameter name="body" valueType="STATIC">
       Orig Header ID: %WWT_STG_ORDER_HEADERS/ORIG_HEADER_ID%
       
       Error Code Returned from WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids: %WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/returnErrorCode%:

       Error Message Returned from WWT_OM_PARTNER_MAPPING.map_erp_ids_to_ph_ids: %WWT_STG_ORDER_HEADERS/persistedOTOSTempVariables/ErrorMsg%
      </Parameter>
			<ExceptionHandler type="WARN">Could not send email</ExceptionHandler>
		</Action>
	</ConditionSet>
</Rule>
	
</ProcessingGroup>